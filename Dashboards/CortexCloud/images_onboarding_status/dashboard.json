{
  "dashboards_data": [
    {
      "name": "CNAPP - Container/VM Image Protection/Scan Status",
      "description": "Status of discovered Images protection and scanning, VM Images, Container Image Registries, Repositories and Container Images",
      "status": "ENABLED",
      "layout": [
        {
          "id": "row-3617",
          "data": [
            {
              "key": "xql_1761675780713",
              "data": {
                "type": "Custom XQL",
                "width": 20,
                "height": 793,
                "params": [
                  {
                    "name": "FilteredGroup_ID",
                    "value": "*"
                  },
                  {
                    "name": "FilteredApplication",
                    "value": "*"
                  },
                  {
                    "name": "FilteredApplication_Owner",
                    "value": "*"
                  },
                  {
                    "name": "FilteredEnvironment",
                    "value": "*"
                  },
                  {
                    "name": "FilteredRealm",
                    "value": "*"
                  },
                  {
                    "name": "FilteredProvider",
                    "value": "*"
                  },
                  {
                    "name": "FilteredProtected",
                    "value": "*"
                  }
                ],
                "phrase": "dataset = asset_inventory\n| filter xdm.asset.type.category = \"VM Image\"\n| filter xdm.asset.realm != \"ON_PREM\"\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n| fields xdm.asset.name, xdm.asset.strong_id, xdm.asset.provider, xdm.asset.cloud.region, xdm.asset.realm, xdm.asset.type.name, xdm.asset.tags, xdm.asset.normalized_fields, xdm.asset.raw_fields, xdm.asset.last_observed, xdm.kubernetes.cluster.name, xdm.image.visibility\n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = uppercase(coalesce(xdm.asset.tags -> [\"Environment\"], \"None\"))\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n| filter Function not contains \"SDWAN\" and Function not contains \"Firewall\" and Function not contains \"Panorama\"\n| filter Group_ID in ($FilteredGroup_ID)\n| filter Application in ($FilteredApplication)\n| filter Application_Owner in ($FilteredApplication_Owner)\n| filter Environment in ($FilteredEnvironment)\n| alter scanType = xdm.asset.raw_fields -> CWP[\"analysis-info_csa_vulnerability_analyzer\"].scanner_type\n| alter agentType = xdm.asset.normalized_fields -> [\"xdm.agent.type\"]\n| alter Agentless = xdm.asset.raw_fields -> CWP[\"analysis-info_agentless_vulnerability_analyzer\"].scanner_type\n| alter K8S_Cluster = xdm.kubernetes.cluster.name\n| alter Backup = xdm.asset.tags -> [\"aws:backup:source-resource\"]\n| alter Protected = if(Agentless = \"agentless\" and Backup != null, \"Agentless Scan (Backup)\", Agentless = \"agentless\", \"Agentless Scan\", xdm.image.visibility = \"PUBLIC\", \"Not Supported\", Agentless = null and Backup != null, \"Not Scanned (Backup)\", Agentless = null, \"Not Scanned/Protected\")\n| filter Protected in ($FilteredProtected)\n| fields xdm.asset.name as Name, xdm.asset.strong_id as ResourceID, xdm.asset.provider as Cloud, xdm.asset.cloud.region as Region, xdm.asset.realm as Cloud_Account, Protected, agentType, Function\n| comp count(Name) as VM_Images by protected\n| sort desc VM_Images   \n\n\n| view graph type = pie xaxis = protected yaxis = VM_Images valuecolor(\"Not Scanned/Protected\",\"#ec0101\") valuecolor(\"Agentless Scan\",\"#5400ff\") valuecolor(\"Not Supported\",\"#f8ff00\") ",
                "time_frame": {
                  "relativeTime": 86400000
                },
                "viewOptions": {
                  "type": "pie",
                  "commands": [
                    {
                      "command": {
                        "op": "=",
                        "name": "xaxis",
                        "value": "protected"
                      }
                    },
                    {
                      "command": {
                        "op": "=",
                        "name": "yaxis",
                        "value": "VM_Images"
                      }
                    },
                    {
                      "func": {
                        "args": [
                          "Not Scanned/Protected",
                          "#ec0101"
                        ],
                        "name": "valuecolor"
                      }
                    },
                    {
                      "func": {
                        "args": [
                          "Agentless Scan",
                          "#5400ff"
                        ],
                        "name": "valuecolor"
                      }
                    },
                    {
                      "func": {
                        "args": [
                          "Not Supported",
                          "#f8ff00"
                        ],
                        "name": "valuecolor"
                      }
                    }
                  ]
                },
                "drilldown_config": {
                  "actionData": {
                    "timeRange": "dashboard_timeframe",
                    "xqlPhrase": "dataset = asset_inventory\n\n| filter xdm.asset.type.category = \"VM Image\"\n| alter scanType = xdm.asset.raw_fields -> CWP[\"analysis-info_csa_vulnerability_analyzer\"].scanner_type\n| alter agentType =  xdm.asset.normalized_fields -> [\"xdm.agent.type\"]\n| alter Agentless = xdm.asset.raw_fields -> CWP[\"analysis-info_agentless_vulnerability_analyzer\"].scanner_type\n| alter Owner = xdm.asset.raw_fields -> [\"Platform Discovery\"][\"image\"].imageOwnerAlias\n| alter Platform = xdm.asset.raw_fields -> [\"Platform Discovery\"][\"image\"].platformDetails\n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = coalesce(xdm.asset.tags -> [\"Environment\"], \"None\")\n| alter Environment= uppercase(Environment)\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n\n| alter Backup = xdm.asset.tags -> [\"aws:backup:source-resource\"]\n| alter Protected = if (Agentless = \"agentless\" and Backup != null, \"Agentless Scan (Backup)\", Agentless = \"agentless\", \"Agentless Scan\", xdm.image.visibility = \"PUBLIC\", \"Not Supported\", agentType = null and Backup != null, \"Not Scanned (Backup)\", agentType = null , \"Not Scanned/Protected\") \n\n| fields  Group_ID, Application, ApplicationCI, Application_Owner, Environment, Function, Protected, xdm.image.visibility as Visibility, Backup, Platform, xdm.asset.name as Name, xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type, xdm.asset.provider as Cloud, xdm.asset.cloud.region as Region, xdm.asset.realm as Cloud_Account, xdm.image.architecture as Architecture, Agentless, Backup, xdm.asset.tags as Tags, xdm.asset.last_observed as Last_Observed\n\n\n",
                    "timePicker": [],
                    "openInNewTab": true
                  },
                  "actionType": "open_xql_search"
                },
                "gridRawStorageInfo": {
                  "sort": null,
                  "coldefs": {},
                  "rowHeight": "{\"rowHeight\":\"regular\",\"gridRowsHeight\":\"medium-row\"}",
                  "columnWidth": "\"stretch\""
                }
              }
            },
            {
              "key": "xql_1762284914912",
              "data": {
                "type": "Custom XQL",
                "width": 20,
                "height": 793,
                "params": [
                  {
                    "name": "FilteredProtected",
                    "value": "*"
                  },
                  {
                    "name": "FilteredGroup_ID",
                    "value": "*"
                  },
                  {
                    "name": "FilteredApplication",
                    "value": "*"
                  },
                  {
                    "name": "FilteredApplication_Owner",
                    "value": "*"
                  },
                  {
                    "name": "FilteredEnvironment",
                    "value": "*"
                  },
                  {
                    "name": "FilteredRealm",
                    "value": "*"
                  },
                  {
                    "name": "FilteredProvider",
                    "value": "*"
                  }
                ],
                "phrase": "dataset = asset_inventory\n| filter xdm.asset.type.name in (\"Container Image\")\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n| fields xdm.asset.name, xdm.asset.strong_id, xdm.asset.provider, xdm.asset.cloud.region, xdm.asset.realm, xdm.asset.type.name, xdm.asset.tags, xdm.asset.raw_fields, xdm.asset.last_observed\n| alter Scan_Status = xdm.asset.raw_fields -> CWP[\"analysis-info_csa_compliance_publisher\"].scan_analysis_result\n| alter Protected = if(Scan_Status = \"success\", \"Agentless Scan\", Scan_Status = null, \"Not Scanned/Protected\")\n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = uppercase(coalesce(xdm.asset.tags -> [\"Environment\"], \"None\"))\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n| filter Protected in ($FilteredProtected)\n| filter Group_ID in ($FilteredGroup_ID)\n| filter Application in ($FilteredApplication)\n| filter Application_Owner in ($FilteredApplication_Owner)\n| filter Environment in ($FilteredEnvironment)\n| fields Group_ID, Application, ApplicationCI, Application_Owner, Environment, Function, Protected, Scan_Status, xdm.asset.name as Name, xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type, xdm.asset.provider as Cloud, xdm.asset.cloud.region as Region, xdm.asset.realm as Cloud_Account, xdm.asset.tags as Tags, xdm.asset.last_observed as Last_Observed\n| comp count(Name) as Container_Images by protected\n| sort desc Container_Images   \n\n\n| view graph type = pie xaxis = protected yaxis = Container_Images valuecolor(\"Not Scanned/Protected\",\"#ec0101\") valuecolor(\"Agentless Scan\",\"#5400ff\") ",
                "time_frame": {
                  "relativeTime": 86400000
                },
                "viewOptions": {
                  "type": "pie",
                  "commands": [
                    {
                      "command": {
                        "op": "=",
                        "name": "xaxis",
                        "value": "protected"
                      }
                    },
                    {
                      "command": {
                        "op": "=",
                        "name": "yaxis",
                        "value": "Container_Images"
                      }
                    },
                    {
                      "func": {
                        "args": [
                          "Not Scanned/Protected",
                          "#ec0101"
                        ],
                        "name": "valuecolor"
                      }
                    }
                  ]
                },
                "drilldown_config": {
                  "actionData": {
                    "timeRange": "dashboard_timeframe",
                    "xqlPhrase": "dataset = asset_inventory\n| filter xdm.asset.type.name in (\"Container Instance\")\n| alter Scan_Status  = xdm.asset.raw_fields -> CWP[\"analysis-info_agentless_vulnerability_analyzer\"].scan_analysis_result\n| alter Protected = if (Scan_Status = \"success\", \"Agentless Scan\", Scan_Status = null , \"Not Scanned/Protected\") \n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = coalesce(xdm.asset.tags -> [\"Environment\"], \"None\")\n| alter Environment= uppercase(Environment)\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n\n\n| fields Group_ID, Application, ApplicationCI, Application_Owner, Environment, Function, Protected, Scan_Status, xdm.asset.name as Name, xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type, xdm.asset.provider as Cloud, xdm.asset.realm as Cloud_Account, xdm.asset.cloud.region as Cloud_Region, xdm.asset.last_observed as Last_Observed",
                    "timePicker": [],
                    "openInNewTab": true
                  },
                  "actionType": "open_xql_search"
                },
                "gridRawStorageInfo": {
                  "sort": "{\"colId\":\"Protected\",\"sort\":\"desc\"}",
                  "coldefs": {},
                  "rowHeight": "{\"rowHeight\":\"stretch\",\"gridRowsHeight\":\"high-row\"}",
                  "columnWidth": "\"stretch\""
                }
              }
            },
            {
              "key": "xql_1762343679812",
              "data": {
                "type": "Custom XQL",
                "width": 20,
                "height": 793,
                "params": [
                  {
                    "name": "FilteredProtected",
                    "value": "*"
                  },
                  {
                    "name": "FilteredGroup_ID",
                    "value": "*"
                  },
                  {
                    "name": "FilteredApplication",
                    "value": "*"
                  },
                  {
                    "name": "FilteredApplication_Owner",
                    "value": "*"
                  },
                  {
                    "name": "FilteredEnvironment",
                    "value": "*"
                  },
                  {
                    "name": "FilteredRealm",
                    "value": "*"
                  },
                  {
                    "name": "FilteredProvider",
                    "value": "*"
                  }
                ],
                "phrase": "dataset = asset_inventory\n| filter xdm.asset.type.name in (\"Container Registry\")\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n| fields xdm.asset.name, xdm.asset.strong_id, xdm.asset.provider, xdm.asset.realm, xdm.asset.type.name, xdm.asset.tags, xdm.asset.raw_fields, xdm.asset.last_observed\n| alter Scan_Status = xdm.asset.raw_fields -> CWP[\"analysis-info__compliance_publisher\"].scan_analysis_result\n| alter AzurePublic = xdm.asset.raw_fields -> [\"Platform Discovery\"][\"properties\"].publicNetworkAccess\n| alter AwsPublic = xdm.asset.raw_fields -> [\"Platform Discovery\"].public\n| alter Public = if(AzurePublic != null, AzurePublic, AwsPublic != null, AwsPublic)\n| alter Repositories = xdm.asset.raw_fields -> [\"Platform Discovery\"][\"repositories\"][]\n| alter Protected = if(Scan_Status = \"success\", \"Agentless Scan\", Scan_Status = null, \"Not Scanned/Protected\")\n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = uppercase(coalesce(xdm.asset.tags -> [\"Environment\"], \"None\"))\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n| filter Protected in ($FilteredProtected)\n| filter Group_ID in ($FilteredGroup_ID)\n| filter Application in ($FilteredApplication)\n| filter Application_Owner in ($FilteredApplication_Owner)\n| filter Environment in ($FilteredEnvironment)\n| fields Protected, Public, xdm.asset.name as Name, xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type, xdm.asset.provider as Regitry_Type, xdm.asset.realm as Cloud_Account, Repositories, xdm.asset.tags as Tags, xdm.asset.last_observed as Last_Observed\n| comp count(Name) as Registries by protected\n| sort desc Registries \n\n\n| view graph type = pie xaxis = protected yaxis = Registries valuecolor(\"Not Scanned/Protected\",\"#ec0101\") valuecolor(\"Agentless Scan\",\"#5400ff\") ",
                "time_frame": {
                  "relativeTime": 86400000
                },
                "viewOptions": {
                  "type": "pie",
                  "commands": [
                    {
                      "command": {
                        "op": "=",
                        "name": "xaxis",
                        "value": "protected"
                      }
                    },
                    {
                      "command": {
                        "op": "=",
                        "name": "yaxis",
                        "value": "Registries"
                      }
                    },
                    {
                      "func": {
                        "args": [
                          "Not Scanned/Protected",
                          "#ec0101"
                        ],
                        "name": "valuecolor"
                      }
                    },
                    {
                      "func": {
                        "args": [
                          "Agentless Scan",
                          "#5400ff"
                        ],
                        "name": "valuecolor"
                      }
                    }
                  ]
                },
                "drilldown_config": {
                  "actionData": {
                    "timeRange": "dashboard_timeframe",
                    "xqlPhrase": "dataset = asset_inventory\n| filter xdm.asset.type.name in (\"Container Registry\")\n| alter Scan_Status  = xdm.asset.raw_fields -> CWP[\"analysis-info__compliance_publisher\"].scan_analysis_result\n| alter AzurePublic = xdm.asset.raw_fields -> [\"Platform Discovery\"][\"properties\"].publicNetworkAccess\n| alter AwsPublic = xdm.asset.raw_fields -> [\"Platform Discovery\"].public\n| alter Public  = if (AzurePublic != null, AzurePublic,  AwsPublic != null , AwsPublic) \n| alter Repositories = xdm.asset.raw_fields -> [\"Platform Discovery\"][\"repositories\"][]\n| alter Protected = if (Scan_Status = \"success\", \"Agentless Scan\", Scan_Status = null , \"Not Scanned/Protected\") \n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = coalesce(xdm.asset.tags -> [\"Environment\"], \"None\")\n| alter Environment= uppercase(Environment)\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n\n| fields Protected,  Public, xdm.asset.name as Name,  xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type, xdm.asset.provider as Regitry_Type, xdm.asset.realm as Cloud_Account, Repositories, xdm.asset.tags as Tags, xdm.asset.last_observed as Last_Observed",
                    "timePicker": [],
                    "openInNewTab": true
                  },
                  "actionType": "open_xql_search"
                },
                "gridRawStorageInfo": {
                  "sort": "{\"colId\":\"Protected\",\"sort\":\"asc\"}",
                  "coldefs": {},
                  "rowHeight": "{\"rowHeight\":\"stretch\",\"gridRowsHeight\":\"high-row\"}",
                  "columnWidth": "\"stretch\""
                }
              }
            },
            {
              "key": "xql_1762282748068",
              "data": {
                "type": "Custom XQL",
                "width": 20,
                "height": 793,
                "params": [
                  {
                    "name": "FilteredProtected",
                    "value": "*"
                  },
                  {
                    "name": "FilteredGroup_ID",
                    "value": "*"
                  },
                  {
                    "name": "FilteredApplication",
                    "value": "*"
                  },
                  {
                    "name": "FilteredApplication_Owner",
                    "value": "*"
                  },
                  {
                    "name": "FilteredEnvironment",
                    "value": "*"
                  },
                  {
                    "name": "FilteredRealm",
                    "value": "*"
                  },
                  {
                    "name": "FilteredProvider",
                    "value": "*"
                  }
                ],
                "phrase": "dataset = asset_inventory\n| filter xdm.asset.type.name in (\"Container Image Repository\")\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n| fields xdm.asset.name, xdm.asset.strong_id, xdm.asset.provider, xdm.asset.realm, xdm.asset.type.name, xdm.asset.tags, xdm.asset.raw_fields, xdm.asset.last_observed\n| alter Scan_Status = xdm.asset.raw_fields -> CWP[\"analysis-info__compliance_publisher\"].scan_analysis_result\n| alter Public = xdm.asset.raw_fields -> [\"Platform Discovery\"].public\n| alter registryURL = xdm.asset.raw_fields -> CWP[\"discovery_data\"].registryURL\n| alter Protected = if(Scan_Status = \"success\", \"Agentless Scan\", Scan_Status = null, \"Not Scanned/Protected\")\n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = uppercase(coalesce(xdm.asset.tags -> [\"Environment\"], \"None\"))\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n| filter Protected in ($FilteredProtected)\n| filter Group_ID in ($FilteredGroup_ID)\n| filter Application in ($FilteredApplication)\n| filter Application_Owner in ($FilteredApplication_Owner)\n| filter Environment in ($FilteredEnvironment)\n| fields Protected, Public, registryURL, xdm.asset.name as Name, xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type, xdm.asset.provider as Registry_Type, xdm.asset.realm as Cloud_Account, xdm.asset.tags as Tags, xdm.asset.last_observed as Last_Observed\n| comp count(Name) as Repositories by protected\n| sort desc Repositories\n\n\n| view graph type = pie xaxis = protected yaxis = Repositories valuecolor(\"Not Scanned/Protected\",\"#ec0101\") valuecolor(\"Agentless Scan\",\"#5400ff\") ",
                "time_frame": {
                  "relativeTime": 86400000
                },
                "viewOptions": {
                  "type": "pie",
                  "commands": [
                    {
                      "command": {
                        "op": "=",
                        "name": "xaxis",
                        "value": "protected"
                      }
                    },
                    {
                      "command": {
                        "op": "=",
                        "name": "yaxis",
                        "value": "Repositories"
                      }
                    },
                    {
                      "func": {
                        "args": [
                          "Agentless Scan",
                          "#5400ff"
                        ],
                        "name": "valuecolor"
                      }
                    },
                    {
                      "func": {
                        "args": [
                          "Not Scanned/Protected",
                          "#e60404"
                        ],
                        "name": "valuecolor"
                      }
                    }
                  ]
                },
                "drilldown_config": {
                  "actionData": {
                    "timeRange": "dashboard_timeframe",
                    "xqlPhrase": "dataset = asset_inventory\n| filter xdm.asset.type.name in (\"Container Image Repository\")\n| alter Scan_Status  = xdm.asset.raw_fields -> CWP[\"analysis-info__compliance_publisher\"].scan_analysis_result\n| alter Public  = xdm.asset.raw_fields -> [\"Platform Discovery\"].public\n| alter registryURL  = xdm.asset.raw_fields -> CWP[\"discovery_data\"].registryURL\n| alter Protected = if (Scan_Status = \"success\", \"Agentless Scan\", Scan_Status = null , \"Not Scanned/Protected\") \n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = coalesce(xdm.asset.tags -> [\"Environment\"], \"None\")\n| alter Environment= uppercase(Environment)\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n| alter Function_Handler  = xdm.asset.raw_fields -> [\"Platform Discovery\"].Handler\n\n| fields Group_ID, Application, ApplicationCI, Application_Owner, Environment, Function, Protected, Scan_Status, Public, registryURL, xdm.asset.name as Name, xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type, xdm.asset.provider as Regitry_Type, xdm.asset.realm as Cloud_Account, xdm.asset.cloud.region as Cloud_Region, xdm.asset.last_observed as Last_Observed",
                    "timePicker": [],
                    "openInNewTab": true
                  },
                  "actionType": "open_xql_search"
                },
                "gridRawStorageInfo": {
                  "sort": "{\"colId\":\"Protected\",\"sort\":\"desc\"}",
                  "coldefs": {},
                  "rowHeight": "{\"rowHeight\":\"stretch\",\"gridRowsHeight\":\"high-row\"}",
                  "columnWidth": "\"stretch\""
                }
              }
            },
            {
              "key": "xql_1761784771762",
              "data": {
                "type": "Custom XQL",
                "width": 20,
                "height": 793,
                "params": [
                  {
                    "name": "FilteredProtected",
                    "value": "*"
                  },
                  {
                    "name": "FilteredGroup_ID",
                    "value": "*"
                  },
                  {
                    "name": "FilteredApplication",
                    "value": "*"
                  },
                  {
                    "name": "FilteredApplication_Owner",
                    "value": "*"
                  },
                  {
                    "name": "FilteredEnvironment",
                    "value": "*"
                  },
                  {
                    "name": "FilteredRealm",
                    "value": "*"
                  },
                  {
                    "name": "FilteredProvider",
                    "value": "*"
                  }
                ],
                "phrase": "dataset = asset_inventory\n| filter xdm.asset.type.name in (\"Registry Image\")\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n| fields xdm.asset.name, xdm.asset.strong_id, xdm.asset.provider, xdm.asset.cloud.region, xdm.asset.realm, xdm.asset.type.name, xdm.asset.tags, xdm.asset.normalized_fields, xdm.asset.raw_fields, xdm.asset.last_observed\n| alter image_scan = xdm.asset.raw_fields -> CWP[\"analysis-info__compliance_publisher\"].scan_analysis_result\n| alter imageTags = xdm.asset.raw_fields -> CWP[\"discovery_data\"].imageTags[]\n| alter RepositoryName = xdm.asset.raw_fields -> CWP[\"discovery_data\"].repositoryName\n| alter registryURL = xdm.asset.raw_fields -> CWP[\"discovery_data\"].registryURL\n| alter Protected = if(image_scan = \"success\", \"Agentless Scan\", image_scan = null, \"Not Scanned/Protected\")\n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = uppercase(coalesce(xdm.asset.tags -> [\"Environment\"], \"None\"))\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n| filter Protected in ($FilteredProtected)\n| filter Group_ID in ($FilteredGroup_ID)\n| filter Application in ($FilteredApplication)\n| filter Application_Owner in ($FilteredApplication_Owner)\n| filter Environment in ($FilteredEnvironment)\n| fields Protected, registryURL, RepositoryName, imageTags, xdm.asset.name as Name, xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type, xdm.asset.provider as Cloud, xdm.asset.cloud.region as Cloud_Region, xdm.asset.realm as Cloud_Account, xdm.asset.tags as Tags, xdm.asset.last_observed as Last_Observed\n| comp count(Name) as Registry_Images by protected\n| sort desc Registry_Images\n\n\n| view graph type = pie xaxis = protected yaxis = Registry_Images valuecolor(\"Not Scanned/Protected\",\"#ec0101\") valuecolor(\"Agentless Scan\",\"#5400ff\") ",
                "time_frame": {
                  "relativeTime": 86400000
                },
                "viewOptions": {
                  "type": "pie",
                  "commands": [
                    {
                      "command": {
                        "op": "=",
                        "name": "xaxis",
                        "value": "protected"
                      }
                    },
                    {
                      "command": {
                        "op": "=",
                        "name": "yaxis",
                        "value": "Images"
                      }
                    },
                    {
                      "func": {
                        "args": [
                          "Not Scanned/Protected",
                          "#ec0101"
                        ],
                        "name": "valuecolor"
                      }
                    },
                    {
                      "func": {
                        "args": [
                          "Agentless Scan",
                          "#0019ff"
                        ],
                        "name": "valuecolor"
                      }
                    }
                  ]
                },
                "drilldown_config": {
                  "actionData": {
                    "timeRange": "dashboard_timeframe",
                    "xqlPhrase": "dataset = asset_inventory\n| filter xdm.asset.type.name in (\"Registry Image\")\n| alter image_scan  = xdm.asset.raw_fields -> CWP[\"analysis-info__compliance_publisher\"].scan_analysis_result\n| alter repositoryName  = xdm.asset.raw_fields -> CWP[\"discovery_data\"].repositoryName\n| alter registryURL  = xdm.asset.raw_fields -> CWP[\"discovery_data\"].registryURL\n| alter Labels  = xdm.asset.raw_fields -> CWP[\"discovery_data\"][\"config\"].Labels\n| alter imageTags  = xdm.asset.raw_fields -> CWP[\"discovery_data\"].imageTags[] \n| alter Architecture  = xdm.asset.raw_fields -> CWP[\"discovery_data\"].architecture\n| alter OS  = xdm.asset.raw_fields -> CWP[\"discovery_data\"].os\n\n| alter Protected = if (repositoryName != null and image_scan = \"success\", \"Agentless Scan\", repositoryName = null , \"Not Scanned Registry Image\") \n\n\n| fields Protected, repositoryName, registryURL, xdm.asset.name as Name, imageTags, Architecture, OS, xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type, xdm.asset.provider as Regitry_Type, xdm.asset.realm as Cloud_Account, xdm.asset.tags as Tags, xdm.asset.last_observed as Last_Observed\n",
                    "timePicker": [],
                    "openInNewTab": true
                  },
                  "actionType": "open_xql_search"
                }
              }
            }
          ]
        },
        {
          "id": "row-394",
          "data": [
            {
              "key": "xql_1761676865710",
              "data": {
                "type": "Custom XQL",
                "width": 100,
                "height": 400,
                "params": [
                  {
                    "name": "FilteredGroup_ID",
                    "value": "*"
                  },
                  {
                    "name": "FilteredApplication",
                    "value": "*"
                  },
                  {
                    "name": "FilteredApplication_Owner",
                    "value": "*"
                  },
                  {
                    "name": "FilteredEnvironment",
                    "value": "*"
                  },
                  {
                    "name": "FilteredRealm",
                    "value": "*"
                  },
                  {
                    "name": "FilteredProvider",
                    "value": "*"
                  },
                  {
                    "name": "FilteredProtected",
                    "value": "*"
                  }
                ],
                "phrase": "dataset = asset_inventory\n| filter xdm.asset.type.category = \"VM Image\"\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n| fields xdm.asset.name, xdm.asset.strong_id, xdm.asset.provider, xdm.asset.cloud.region, xdm.asset.realm, xdm.asset.type.name, xdm.asset.tags, xdm.asset.normalized_fields, xdm.asset.raw_fields, xdm.asset.last_observed, xdm.image.visibility, xdm.image.architecture\n//| filter xdm.asset.provider  = \"azure\"\n| alter scanType = xdm.asset.raw_fields -> CWP[\"analysis-info_csa_vulnerability_analyzer\"].scanner_type\n| alter agentType =  xdm.asset.normalized_fields -> [\"xdm.agent.type\"]\n| alter Agentless = xdm.asset.raw_fields -> CWP[\"analysis-info_agentless_vulnerability_analyzer\"].scanner_type\n| alter Owner = xdm.asset.raw_fields -> [\"Platform Discovery\"][\"image\"].imageOwnerAlias\n// | alter ImageTags = xdm.asset.raw_fields -> [\"Platform Discovery\"][\"image\"].tags[]\n| alter Platform = xdm.asset.raw_fields -> [\"Platform Discovery\"][\"image\"].platformDetails\n| alter Backup = xdm.asset.tags -> [\"aws:backup:source-resource\"]\n\n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = uppercase(coalesce(xdm.asset.tags -> [\"Environment\"], \"None\"))\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n| filter Group_ID in ($FilteredGroup_ID)\n| filter Application in ($FilteredApplication)\n| filter Application_Owner in ($FilteredApplication_Owner)\n| filter Environment in ($FilteredEnvironment)\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n| alter Protected = if (Agentless = \"agentless\" and Backup != null, \"Agentless Scan (Backup)\", Agentless = \"agentless\", \"Agentless Scan\", xdm.image.visibility = \"PUBLIC\", \"Not Supported\", Agentless = null and Backup != null, \"Not Scanned (Backup)\", Agentless = null , \"Not Scanned/Protected\") \n| filter Protected in ($FilteredProtected)\n\n| fields   Protected, xdm.image.visibility as Visibility, Owner, Backup, Platform, xdm.asset.name as Name, xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type, xdm.asset.provider as Cloud, xdm.asset.cloud.region as Region, xdm.asset.realm as Cloud_Account, xdm.image.architecture as Architecture, xdm.asset.tags as Tags, xdm.asset.last_observed as Last_Observed, Group_ID, Application, ApplicationCI, Application_Owner, Environment, Function\n\n\n",
                "entityType": "xql-widget-table-730fb74c-06c8-46ff-8aa4-21efc12ee899",
                "time_frame": {
                  "relativeTime": 86400000
                },
                "viewOptions": {
                  "type": "table",
                  "commands": []
                },
                "gridRawStorageInfo": {
                  "sort": "{\"colId\":\"Region\",\"sort\":\"desc\"}",
                  "coldefs": {},
                  "rowHeight": "{\"rowHeight\":\"thin\",\"gridRowsHeight\":\"small-row\"}",
                  "columnWidth": "\"stretch\""
                }
              }
            }
          ]
        },
        {
          "id": "row-8087",
          "data": [
            {
              "key": "xql_1762278606466",
              "data": {
                "type": "Custom XQL",
                "width": 100,
                "height": 400,
                "params": [
                  {
                    "name": "FilteredProtected",
                    "value": "*"
                  },
                  {
                    "name": "FilteredGroup_ID",
                    "value": "*"
                  },
                  {
                    "name": "FilteredApplication",
                    "value": "*"
                  },
                  {
                    "name": "FilteredApplication_Owner",
                    "value": "*"
                  },
                  {
                    "name": "FilteredEnvironment",
                    "value": "*"
                  },
                  {
                    "name": "FilteredRealm",
                    "value": "*"
                  },
                  {
                    "name": "FilteredProvider",
                    "value": "*"
                  }
                ],
                "phrase": "dataset = asset_inventory\n| filter xdm.asset.type.name in (\"Container Registry\")\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n| fields xdm.asset.name, xdm.asset.strong_id, xdm.asset.provider, xdm.asset.realm, xdm.asset.type.name, xdm.asset.tags, xdm.asset.raw_fields, xdm.asset.last_observed\n| alter Scan_Status  = xdm.asset.raw_fields -> CWP[\"analysis-info__compliance_publisher\"].scan_analysis_result\n| alter AzurePublic = xdm.asset.raw_fields -> [\"Platform Discovery\"][\"properties\"].publicNetworkAccess\n| alter AwsPublic = xdm.asset.raw_fields -> [\"Platform Discovery\"].public\n| alter Public  = if (AzurePublic != null, AzurePublic,  AwsPublic != null , AwsPublic) \n| alter Repositories = xdm.asset.raw_fields -> [\"Platform Discovery\"][\"repositories\"][]\n| alter Protected = if (Scan_Status = \"success\", \"Agentless Scan\", Scan_Status = null , \"Not Scanned/Protected\") \n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = uppercase(coalesce(xdm.asset.tags -> [\"Environment\"], \"None\"))\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n| filter Protected in ($FilteredProtected)\n| filter Group_ID in ($FilteredGroup_ID)\n| filter Application in ($FilteredApplication)\n| filter Application_Owner in ($FilteredApplication_Owner)\n| filter Environment in ($FilteredEnvironment)\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n| fields Protected,  Public, xdm.asset.name as Name,  xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type, xdm.asset.provider as Registry_Type, xdm.asset.realm as Cloud_Account, Repositories, xdm.asset.tags as Tags, xdm.asset.last_observed as Last_Observed",
                "entityType": "xql-widget-table-76e252f3-bff3-4d68-81f7-2fbfdfb2a5df",
                "time_frame": {
                  "relativeTime": 86400000
                },
                "viewOptions": {
                  "type": "table",
                  "commands": []
                },
                "gridRawStorageInfo": {
                  "sort": "{\"colId\":\"Regitry_Type\",\"sort\":\"desc\"}",
                  "coldefs": {},
                  "rowHeight": "{\"rowHeight\":\"thin\",\"gridRowsHeight\":\"small-row\"}",
                  "columnWidth": "\"stretch\""
                }
              }
            }
          ]
        },
        {
          "id": "row-2397",
          "data": [
            {
              "key": "xql_1762282514751",
              "data": {
                "type": "Custom XQL",
                "width": 100,
                "height": 400,
                "params": [
                  {
                    "name": "FilteredProtected",
                    "value": "*"
                  },
                  {
                    "name": "FilteredGroup_ID",
                    "value": "*"
                  },
                  {
                    "name": "FilteredApplication",
                    "value": "*"
                  },
                  {
                    "name": "FilteredApplication_Owner",
                    "value": "*"
                  },
                  {
                    "name": "FilteredEnvironment",
                    "value": "*"
                  },
                  {
                    "name": "FilteredRealm",
                    "value": "*"
                  },
                  {
                    "name": "FilteredProvider",
                    "value": "*"
                  }
                ],
                "phrase": "dataset = asset_inventory\n| filter xdm.asset.type.name in (\"Container Image Repository\")\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n| fields xdm.asset.name, xdm.asset.strong_id, xdm.asset.provider, xdm.asset.realm, xdm.asset.type.name, xdm.asset.tags, xdm.asset.raw_fields, xdm.asset.last_observed\n| alter Scan_Status  = xdm.asset.raw_fields -> CWP[\"analysis-info__compliance_publisher\"].scan_analysis_result\n| alter Public  = xdm.asset.raw_fields -> [\"Platform Discovery\"].public\n| alter registryURL  = xdm.asset.raw_fields -> CWP[\"discovery_data\"].registryURL\n| alter Protected = if (Scan_Status = \"success\", \"Agentless Scan\", Scan_Status = null , \"Not Scanned/Protected\") \n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = uppercase(coalesce(xdm.asset.tags -> [\"Environment\"], \"None\"))\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n| alter Function_Handler  = xdm.asset.raw_fields -> [\"Platform Discovery\"].Handler\n| filter Protected in ($FilteredProtected)\n\n| filter Group_ID in ($FilteredGroup_ID)\n| filter Application in ($FilteredApplication)\n| filter Application_Owner in ($FilteredApplication_Owner)\n| filter Environment in ($FilteredEnvironment)\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n\n| fields  Protected, Public, registryURL, xdm.asset.name as Name, xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type, xdm.asset.provider as Registry_Type, xdm.asset.realm as Cloud_Account, xdm.asset.cloud.region as Cloud_Region, xdm.asset.last_observed as Last_Observed, Group_ID, Application, ApplicationCI, Application_Owner, Environment, Function",
                "entityType": "xql-widget-table-ab023f1a-7d65-407a-afd0-089a2283b437",
                "time_frame": {
                  "relativeTime": 86400000
                },
                "viewOptions": {
                  "type": "table",
                  "commands": []
                },
                "gridRawStorageInfo": {
                  "sort": "{\"colId\":\"Protected\",\"sort\":\"desc\"}",
                  "coldefs": {},
                  "rowHeight": "{\"rowHeight\":\"thin\",\"gridRowsHeight\":\"small-row\"}",
                  "columnWidth": "\"stretch\""
                }
              }
            }
          ]
        },
        {
          "id": "row-3298",
          "data": [
            {
              "key": "xql_1762300800981",
              "data": {
                "type": "Custom XQL",
                "width": 100,
                "height": 400,
                "params": [
                  {
                    "name": "FilteredProtected",
                    "value": "*"
                  },
                  {
                    "name": "FilteredRealm",
                    "value": "*"
                  },
                  {
                    "name": "FilteredProvider",
                    "value": "*"
                  }
                ],
                "phrase": "dataset = asset_inventory\n| filter xdm.asset.type.name in (\"Registry Image\")\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n| fields xdm.asset.name, xdm.asset.strong_id, xdm.asset.provider, xdm.asset.cloud.region, xdm.asset.realm, xdm.asset.type.name, xdm.asset.tags, xdm.asset.normalized_fields, xdm.asset.raw_fields, xdm.asset.last_observed\n// | filter xdm.asset.type.name in (\"Runtime Image\", \"Build Image\", \"Registry Image\")\n| alter Scan_Status  = xdm.asset.raw_fields -> CWP[\"scan_information_container_images_registry_caa\"][\"collected_types\"][]\n// | alter image_scan  = xdm.asset.raw_fields -> CWP[\"analysis-info__compliance_publisher\"].scan_analysis_result\n| alter imageTags  = xdm.asset.raw_fields -> CWP[\"discovery_data\"].imageTags[]\n| alter CloudRepositoryName  = xdm.asset.raw_fields -> [\"Platform Discovery\"].repositoryName\n| alter RepositoryName   = xdm.asset.raw_fields -> CWP[\"discovery_data\"].repositoryName\n| alter RepositoryName  = if (RepositoryName != null, RepositoryName,  CloudRepositoryName != null , CloudRepositoryName) \n| alter registryURL  = xdm.asset.raw_fields -> CWP[\"discovery_data\"].registryURL\n// | alter Labels  = xdm.asset.raw_fields -> [\"Platform Discovery\"][\"config\"].Labels\n| alter Labels  = xdm.asset.raw_fields -> CWP[\"discovery_data\"][\"config\"].Labels\n// | alter imageTags  = xdm.asset.raw_fields -> [\"Platform Discovery\"].imageTags\n| alter CloudImageTags  = xdm.asset.raw_fields -> [\"Platform Discovery\"].imageTags[] \n| alter imageTags  = if (imageTags != null, imageTags,  CloudImageTags != null , CloudImageTags) \n| alter Public  = xdm.asset.raw_fields -> [\"Platform Discovery\"].public\n| alter Architecture  = xdm.asset.normalized_fields -> [\"xdm.image.architecture\"]\n| alter Visibility  = xdm.asset.normalized_fields -> [\"xdm.image.visibility\"]\n| alter ImageName  = xdm.asset.normalized_fields -> [\"xdm.image.names\"][]\n| alter OS = xdm.asset.normalized_fields -> [\"xdm.image.os\"]\n| alter  os_distribution = xdm.asset.normalized_fields -> [\"xdm.image.os_distribution\"]\n| alter  os_family = xdm.asset.normalized_fields -> [\"xdm.image.os_family\"]\n| alter  os_release = xdm.asset.normalized_fields -> [\"xdm.image.os_release\"]\n| alter  specification_type = xdm.asset.normalized_fields -> [\"xdm.image.specification_type\"]\n| alter  size = xdm.asset.normalized_fields -> [\"xdm.image.size\"]\n| alter Protected = if (Scan_Status != null, \"Agentless Scan\", Scan_Status = null , \"Not Scanned/Protected\") \n// | alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n// | alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n// | alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n// | alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n// | alter Environment = coalesce(xdm.asset.tags -> [\"Environment\"], \"None\")\n// | alter Environment= uppercase(Environment)\n// | alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n| filter Protected in ($FilteredProtected)\n// | filter Group_ID in ($FilteredGroup_ID)\n// | filter Application in ($FilteredApplication)\n// | filter Application_Owner in ($FilteredApplication_Owner)\n// | filter Environment in ($FilteredEnvironment)\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n\n| fields   Protected, Scan_Status, Visibility, Public, xdm.asset.provider as Cloud, xdm.asset.name as Name, ImageName, imageTags, RepositoryName, registryURL, xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type,xdm.asset.realm as Cloud_Account, xdm.asset.cloud.region as Cloud_Region, Architecture, specification_type, os_release, OS, os_distribution, os_family, size, Labels, xdm.asset.last_observed as Last_Observed",
                "entityType": "xql-widget-table-c59df854-9af2-4aee-ac52-d7cfdd11e289",
                "time_frame": {
                  "relativeTime": 86400000
                },
                "viewOptions": {
                  "type": "table",
                  "commands": []
                },
                "gridRawStorageInfo": {
                  "sort": "{\"colId\":\"xdm__asset__type__name\",\"sort\":\"asc\"}",
                  "coldefs": {},
                  "rowHeight": "{\"rowHeight\":\"thin\",\"gridRowsHeight\":\"small-row\"}",
                  "columnWidth": "\"stretch\""
                }
              }
            }
          ]
        }
      ],
      "default_dashboard_id": 3,
      "global_id": "",
      "metadata": {
        "params": [
          {
            "name": "FilteredProvider",
            "type": "STATIC",
            "title": "Cloud",
            "value": "",
            "valueOptions": [
              "AWS",
              "GCP",
              "AZURE",
              "JFROG_ARTIFACTORY",
              "DOCKER"
            ],
            "investigation": null,
            "filterComponentType": "SINGLE_SELECT"
          },
          {
            "name": "FilteredRealm",
            "type": "DYNAMIC",
            "title": "Account",
            "value": [],
            "executionID": "16be4c60f0c344_5114292_inv",
            "valueOptions": [],
            "investigation": {
              "ttl": "0",
              "timeframe": {
                "relativeTime": 86400000
              },
              "input_dict": {
                "xql": "dataset = asset_inventory \n| fields xdm.asset.realm\n| dedup xdm.asset.realm\n| sort asc xdm.asset.realm\n\n",
                "tenants": [],
                "schedule": null,
                "query_editor": "xql",
                "notification_link": "xql/xql-search/_EXECUTION_ID_",
                "run_in_background": false,
                "query_definition_name": "XQL-QUERY-929599"
              },
              "query_source_metadata": {
                "source": "investigation"
              }
            },
            "investigationError": null,
            "filterComponentType": "MULTI_SELECT",
            "investigationColumn": "xdm.asset.realm"
          },
          {
            "name": "FilteredGroup_ID",
            "type": "DYNAMIC",
            "title": "Group",
            "value": [],
            "executionID": "1583989b54ae4c_5114294_inv",
            "valueOptions": [],
            "investigation": {
              "ttl": "0",
              "timeframe": {
                "relativeTime": 86400000
              },
              "input_dict": {
                "xql": "dataset = asset_inventory \n| alter Group_ID = xdm.asset.tags -> [\"Group_ID\"]\n| fields Group_ID\n| dedup Group_ID\n| sort asc Group_ID\n",
                "tenants": [],
                "schedule": null,
                "query_editor": "xql",
                "notification_link": "xql/xql-search/_EXECUTION_ID_",
                "run_in_background": false,
                "query_definition_name": "XQL-QUERY-929666"
              },
              "query_source_metadata": {
                "source": "investigation"
              }
            },
            "investigationError": null,
            "filterComponentType": "MULTI_SELECT",
            "investigationColumn": "Group_ID"
          },
          {
            "name": "FilteredApplication",
            "type": "DYNAMIC",
            "title": "Application",
            "value": [],
            "executionID": "b81d48367b644f_5114295_inv",
            "valueOptions": [],
            "investigation": {
              "ttl": "0",
              "timeframe": {
                "relativeTime": 86400000
              },
              "input_dict": {
                "xql": "dataset = asset_inventory \n| alter Application = xdm.asset.tags -> [\"Application\"]\n| fields Application\n| dedup Application\n| sort asc Application\n\n// | alter Group_ID = xdm.asset.tags -> [\"Group_ID\"]\n// | alter Application = xdm.asset.tags -> [\"Application\"]\n// | alter Application_Owner = xdm.asset.tags -> [\"Application_Owner\"]\n// | alter Environment = xdm.asset.tags -> [\"Environment\"]",
                "tenants": [],
                "schedule": null,
                "query_editor": "xql",
                "notification_link": "xql/xql-search/_EXECUTION_ID_",
                "run_in_background": false,
                "query_definition_name": "XQL-QUERY-929697"
              },
              "query_source_metadata": {
                "source": "investigation"
              }
            },
            "investigationError": null,
            "filterComponentType": "MULTI_SELECT",
            "investigationColumn": "Application"
          },
          {
            "name": "FilteredApplication_Owner",
            "type": "DYNAMIC",
            "title": "Owner",
            "value": [],
            "executionID": "adf44e0763944d_5114293_inv",
            "valueOptions": [],
            "investigation": {
              "ttl": "0",
              "timeframe": {
                "relativeTime": 86400000
              },
              "input_dict": {
                "xql": "dataset = asset_inventory \n| alter Application_Owner = xdm.asset.tags -> [\"Application_Owner\"]\n| fields Application_Owner\n| dedup Application_Owner\n| sort asc Application_Owner\n\n// | alter Group_ID = xdm.asset.tags -> [\"Group_ID\"]\n// | alter Application = xdm.asset.tags -> [\"Application\"]\n// | alter Application_Owner = xdm.asset.tags -> [\"Application_Owner\"]\n// | alter Environment = xdm.asset.tags -> [\"Environment\"]",
                "tenants": [],
                "schedule": null,
                "query_editor": "xql",
                "notification_link": "xql/xql-search/_EXECUTION_ID_",
                "run_in_background": false,
                "query_definition_name": "XQL-QUERY-929722"
              },
              "query_source_metadata": {
                "source": "investigation"
              }
            },
            "investigationError": null,
            "filterComponentType": "MULTI_SELECT",
            "investigationColumn": "Application_Owner"
          },
          {
            "name": "FilteredEnvironment",
            "type": "DYNAMIC",
            "title": "Environment",
            "value": [],
            "executionID": "dfc61f112ba049_5114296_inv",
            "valueOptions": [],
            "investigation": {
              "ttl": "0",
              "timeframe": {
                "relativeTime": 86400000
              },
              "input_dict": {
                "xql": "dataset = asset_inventory \n| alter Environment = xdm.asset.tags -> [\"Environment\"]\n| alter Environment = uppercase(Environment)\n\n| fields Environment\n| dedup Environment\n| sort asc Environment\n\n// | alter Group_ID = xdm.asset.tags -> [\"Group_ID\"]\n// | alter Application = xdm.asset.tags -> [\"Application\"]\n// | alter Application_Owner = xdm.asset.tags -> [\"Application_Owner\"]\n// | alter Environment = xdm.asset.tags -> [\"Environment\"]",
                "tenants": [],
                "schedule": null,
                "query_editor": "xql",
                "notification_link": "xql/xql-search/_EXECUTION_ID_",
                "run_in_background": false,
                "query_definition_name": "XQL-QUERY-2646390"
              },
              "query_source_metadata": {
                "source": "investigation"
              }
            },
            "investigationError": null,
            "filterComponentType": "MULTI_SELECT",
            "investigationColumn": "Environment"
          },
          {
            "name": "FilteredProtected",
            "type": "STATIC",
            "title": "Protected",
            "value": "",
            "valueOptions": [
              "Not Scanned/Protected",
              "Agentless Scan",
              "Not Supported"
            ],
            "investigation": null,
            "filterComponentType": "MULTI_SELECT"
          }
        ]
      }
    }
  ],
  "widgets_data": [
    {
      "widget_key": "xql_1761675780713",
      "title": "Cloud - VM Images Scan Status",
      "creation_time": 1762357899227,
      "description": "",
      "data": {
        "params": [
          {
            "name": "FilteredGroup_ID",
            "value": "*"
          },
          {
            "name": "FilteredApplication",
            "value": "*"
          },
          {
            "name": "FilteredApplication_Owner",
            "value": "*"
          },
          {
            "name": "FilteredEnvironment",
            "value": "*"
          },
          {
            "name": "FilteredRealm",
            "value": "*"
          },
          {
            "name": "FilteredProvider",
            "value": "*"
          },
          {
            "name": "FilteredProtected",
            "value": "*"
          }
        ],
        "phrase": "dataset = asset_inventory\n| filter xdm.asset.type.category = \"VM Image\"\n| filter xdm.asset.realm != \"ON_PREM\"\n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = coalesce(xdm.asset.tags -> [\"Environment\"], \"None\")\n| alter Environment= uppercase(Environment)\n\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n| filter Group_ID in ($FilteredGroup_ID)\n| filter Application in ($FilteredApplication)\n| filter Application_Owner in ($FilteredApplication_Owner)\n| filter Environment in ($FilteredEnvironment)\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n| filter (Function not contains \"\"\"SDWAN\"\"\" and Function not contains \"\"\"Firewall\"\"\" and Function not contains \"\"\"Panorama\"\"\") \n| alter scanType = xdm.asset.raw_fields -> CWP[\"analysis-info_csa_vulnerability_analyzer\"].scanner_type\n| alter agentType =  xdm.asset.normalized_fields -> [\"xdm.agent.type\"]\n| alter Agentless = xdm.asset.raw_fields -> CWP[\"analysis-info_agentless_vulnerability_analyzer\"].scanner_type\n| alter K8S_Cluster = xdm.kubernetes.cluster.name\n\n| alter Backup = xdm.asset.tags -> [\"aws:backup:source-resource\"]\n| alter Protected = if (Agentless = \"agentless\" and Backup != null, \"Agentless Scan (Backup)\", Agentless = \"agentless\", \"Agentless Scan\", xdm.image.visibility = \"PUBLIC\", \"Not Supported\", Agentless = null and Backup != null, \"Not Scanned (Backup)\", Agentless = null , \"Not Scanned/Protected\") \n\n| filter Protected in ($FilteredProtected)\n\n| fields xdm.asset.name as Name, xdm.asset.strong_id as ResourceID, xdm.asset.provider as Cloud, xdm.asset.cloud.region as Region, xdm.asset.realm as Cloud_Account, Protected, agentType, Function\n\n| comp count (Name ) as VM_Images by protected\n| sort desc VM_Images   \n\n\n\n| view graph type = pie xaxis = protected yaxis = VM_Images valuecolor(\"Not Scanned/Protected\",\"#ec0101\") valuecolor(\"Agentless Scan\",\"#5400ff\") valuecolor(\"Not Supported\",\"#f8ff00\") ",
        "time_frame": {
          "relativeTime": 86400000
        },
        "viewOptions": {
          "type": "pie",
          "commands": [
            {
              "command": {
                "op": "=",
                "name": "xaxis",
                "value": "protected"
              }
            },
            {
              "command": {
                "op": "=",
                "name": "yaxis",
                "value": "VM_Images"
              }
            },
            {
              "func": {
                "args": [
                  "Not Scanned/Protected",
                  "#ec0101"
                ],
                "name": "valuecolor"
              }
            },
            {
              "func": {
                "args": [
                  "Agentless Scan",
                  "#5400ff"
                ],
                "name": "valuecolor"
              }
            },
            {
              "func": {
                "args": [
                  "Not Supported",
                  "#f8ff00"
                ],
                "name": "valuecolor"
              }
            }
          ]
        },
        "gridRawStorageInfo": {
          "sort": null,
          "coldefs": {},
          "rowHeight": "{\"rowHeight\":\"regular\",\"gridRowsHeight\":\"medium-row\"}",
          "columnWidth": "\"stretch\""
        }
      },
      "support_time_range": true,
      "additional_info": {
        "query_tables": [
          "asset_inventory"
        ],
        "query_uses_library": false
      },
      "creator_mail": ""
    },
    {
      "widget_key": "xql_1761676865710",
      "title": "Cloud - VM Images Scan Status - List",
      "creation_time": 1762357900241,
      "description": "",
      "data": {
        "params": [
          {
            "name": "FilteredGroup_ID",
            "value": "*"
          },
          {
            "name": "FilteredApplication",
            "value": "*"
          },
          {
            "name": "FilteredApplication_Owner",
            "value": "*"
          },
          {
            "name": "FilteredEnvironment",
            "value": "*"
          },
          {
            "name": "FilteredRealm",
            "value": "*"
          },
          {
            "name": "FilteredProvider",
            "value": "*"
          },
          {
            "name": "FilteredProtected",
            "value": "*"
          }
        ],
        "phrase": "dataset = asset_inventory\n\n| filter xdm.asset.type.category = \"VM Image\"\n| alter scanType = xdm.asset.raw_fields -> CWP[\"analysis-info_csa_vulnerability_analyzer\"].scanner_type\n| alter agentType =  xdm.asset.normalized_fields -> [\"xdm.agent.type\"]\n| alter Agentless = xdm.asset.raw_fields -> CWP[\"analysis-info_agentless_vulnerability_analyzer\"].scanner_type\n| alter Owner = xdm.asset.raw_fields -> [\"Platform Discovery\"][\"image\"].imageOwnerAlias\n| alter Platform = xdm.asset.raw_fields -> [\"Platform Discovery\"][\"image\"].platformDetails\n| alter Backup = xdm.asset.tags -> [\"aws:backup:source-resource\"]\n\n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = coalesce(xdm.asset.tags -> [\"Environment\"], \"None\")\n| alter Environment= uppercase(Environment)\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n| filter Group_ID in ($FilteredGroup_ID)\n| filter Application in ($FilteredApplication)\n| filter Application_Owner in ($FilteredApplication_Owner)\n| filter Environment in ($FilteredEnvironment)\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n| alter Protected = if (Agentless = \"agentless\" and Backup != null, \"Agentless Scan (Backup)\", Agentless = \"agentless\", \"Agentless Scan\", xdm.image.visibility = \"PUBLIC\", \"Not Supported\", Agentless = null and Backup != null, \"Not Scanned (Backup)\", Agentless = null , \"Not Scanned/Protected\") \n| filter Protected in ($FilteredProtected)\n\n| fields   Protected, xdm.image.visibility as Visibility, Owner, Backup, Platform, xdm.asset.name as Name, xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type, xdm.asset.provider as Cloud, xdm.asset.cloud.region as Region, xdm.asset.realm as Cloud_Account, xdm.image.architecture as Architecture, xdm.asset.tags as Tags, xdm.asset.last_observed as Last_Observed, Group_ID, Application, ApplicationCI, Application_Owner, Environment, Function\n\n\n",
        "time_frame": {
          "relativeTime": 86400000
        },
        "viewOptions": {
          "type": "table",
          "commands": []
        },
        "gridRawStorageInfo": {
          "sort": "{\"colId\":\"xdm__asset__provider\",\"sort\":\"desc\"}",
          "coldefs": {},
          "rowHeight": "{\"rowHeight\":\"regular\",\"gridRowsHeight\":\"medium-row\"}",
          "columnWidth": "\"stretch\""
        }
      },
      "support_time_range": true,
      "additional_info": {
        "query_tables": [
          "asset_inventory"
        ],
        "query_uses_library": false
      },
      "creator_mail": ""
    },
    {
      "widget_key": "xql_1761784771762",
      "title": "Cloud - Registry Images Scan Status",
      "creation_time": 1762357902378,
      "description": "",
      "data": {
        "params": [
          {
            "name": "FilteredProtected",
            "value": "*"
          },
          {
            "name": "FilteredGroup_ID",
            "value": "*"
          },
          {
            "name": "FilteredApplication",
            "value": "*"
          },
          {
            "name": "FilteredApplication_Owner",
            "value": "*"
          },
          {
            "name": "FilteredEnvironment",
            "value": "*"
          },
          {
            "name": "FilteredRealm",
            "value": "*"
          },
          {
            "name": "FilteredProvider",
            "value": "*"
          }
        ],
        "phrase": "dataset = asset_inventory\n| filter xdm.asset.type.name in (\"Registry Image\")\n| alter image_scan  = xdm.asset.raw_fields -> CWP[\"analysis-info__compliance_publisher\"].scan_analysis_result\n| alter repositoryName  = xdm.asset.raw_fields -> CWP[\"discovery_data\"].repositoryName\n| alter registryURL  = xdm.asset.raw_fields -> CWP[\"discovery_data\"].registryURL\n| alter Labels  = xdm.asset.raw_fields -> CWP[\"discovery_data\"][\"config\"].Labels\n| alter imageTags  = xdm.asset.raw_fields -> CWP[\"discovery_data\"].imageTags[] \n| alter Architecture  = xdm.asset.raw_fields -> CWP[\"discovery_data\"].architecture\n| alter OS  = xdm.asset.raw_fields -> CWP[\"discovery_data\"].os\n\n| alter Protected = if (repositoryName != null and image_scan = \"success\", \"Agentless Scan\", repositoryName = null , \"Not Scanned/Protected\") \n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = coalesce(xdm.asset.tags -> [\"Environment\"], \"None\")\n| alter Environment= uppercase(Environment)\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n| filter Protected in ($FilteredProtected)\n\n| filter Group_ID in ($FilteredGroup_ID)\n| filter Application in ($FilteredApplication)\n| filter Application_Owner in ($FilteredApplication_Owner)\n| filter Environment in ($FilteredEnvironment)\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n\n| fields Protected, repositoryName, registryURL, xdm.asset.name as Name, imageTags, Architecture, OS, xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type, xdm.asset.provider as Regitry_Type, xdm.asset.realm as Cloud_Account, xdm.asset.tags as Tags, xdm.asset.last_observed as Last_Observed\n\n| comp count (Name ) as Images by protected\n\n| sort desc Protected   \n\n\n\n\n\n| view graph type = pie xaxis = protected yaxis = Images valuecolor(\"Not Scanned/Protected\",\"#ec0101\") valuecolor(\"Agentless Scan\",\"#0019ff\") ",
        "time_frame": {
          "relativeTime": 86400000
        },
        "viewOptions": {
          "type": "pie",
          "commands": [
            {
              "command": {
                "op": "=",
                "name": "xaxis",
                "value": "protected"
              }
            },
            {
              "command": {
                "op": "=",
                "name": "yaxis",
                "value": "Images"
              }
            },
            {
              "func": {
                "args": [
                  "Not Scanned/Protected",
                  "#ec0101"
                ],
                "name": "valuecolor"
              }
            },
            {
              "func": {
                "args": [
                  "Agentless Scan",
                  "#0019ff"
                ],
                "name": "valuecolor"
              }
            }
          ]
        }
      },
      "support_time_range": true,
      "additional_info": {
        "query_tables": [
          "asset_inventory"
        ],
        "query_uses_library": false
      },
      "creator_mail": ""
    },
    {
      "widget_key": "xql_1762278606466",
      "title": "Cloud - Container Registry Status - List",
      "creation_time": 1762357904303,
      "description": "",
      "data": {
        "params": [
          {
            "name": "FilteredProtected",
            "value": "*"
          },
          {
            "name": "FilteredGroup_ID",
            "value": "*"
          },
          {
            "name": "FilteredApplication",
            "value": "*"
          },
          {
            "name": "FilteredApplication_Owner",
            "value": "*"
          },
          {
            "name": "FilteredEnvironment",
            "value": "*"
          },
          {
            "name": "FilteredRealm",
            "value": "*"
          },
          {
            "name": "FilteredProvider",
            "value": "*"
          }
        ],
        "phrase": "dataset = asset_inventory\n| filter xdm.asset.type.name in (\"Container Registry\")\n| alter Scan_Status  = xdm.asset.raw_fields -> CWP[\"analysis-info__compliance_publisher\"].scan_analysis_result\n| alter AzurePublic = xdm.asset.raw_fields -> [\"Platform Discovery\"][\"properties\"].publicNetworkAccess\n| alter AwsPublic = xdm.asset.raw_fields -> [\"Platform Discovery\"].public\n| alter Public  = if (AzurePublic != null, AzurePublic,  AwsPublic != null , AwsPublic) \n| alter Repositories = xdm.asset.raw_fields -> [\"Platform Discovery\"][\"repositories\"][]\n| alter Protected = if (Scan_Status = \"success\", \"Agentless Scan\", Scan_Status = null , \"Not Scanned/Protected\") \n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = coalesce(xdm.asset.tags -> [\"Environment\"], \"None\")\n| alter Environment= uppercase(Environment)\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n| filter Protected in ($FilteredProtected)\n| filter Group_ID in ($FilteredGroup_ID)\n| filter Application in ($FilteredApplication)\n| filter Application_Owner in ($FilteredApplication_Owner)\n| filter Environment in ($FilteredEnvironment)\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n| fields Protected,  Public, xdm.asset.name as Name,  xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type, xdm.asset.provider as Registry_Type, xdm.asset.realm as Cloud_Account, Repositories, xdm.asset.tags as Tags, xdm.asset.last_observed as Last_Observed",
        "time_frame": {
          "relativeTime": 86400000
        },
        "viewOptions": {
          "type": "table",
          "commands": []
        },
        "gridRawStorageInfo": {
          "sort": "{\"colId\":\"Regitry_Type\",\"sort\":\"desc\"}",
          "coldefs": {},
          "rowHeight": "{\"rowHeight\":\"stretch\",\"gridRowsHeight\":\"high-row\"}",
          "columnWidth": "\"stretch\""
        }
      },
      "support_time_range": true,
      "additional_info": {
        "query_tables": [
          "asset_inventory"
        ],
        "query_uses_library": false
      },
      "creator_mail": ""
    },
    {
      "widget_key": "xql_1762282514751",
      "title": "Cloud - Container Image Repository Status - List",
      "creation_time": 1762357907766,
      "description": "",
      "data": {
        "params": [
          {
            "name": "FilteredProtected",
            "value": "*"
          },
          {
            "name": "FilteredGroup_ID",
            "value": "*"
          },
          {
            "name": "FilteredApplication",
            "value": "*"
          },
          {
            "name": "FilteredApplication_Owner",
            "value": "*"
          },
          {
            "name": "FilteredEnvironment",
            "value": "*"
          },
          {
            "name": "FilteredRealm",
            "value": "*"
          },
          {
            "name": "FilteredProvider",
            "value": "*"
          }
        ],
        "phrase": "dataset = asset_inventory\n| filter xdm.asset.type.name in (\"Container Image Repository\")\n| alter Scan_Status  = xdm.asset.raw_fields -> CWP[\"analysis-info__compliance_publisher\"].scan_analysis_result\n| alter Public  = xdm.asset.raw_fields -> [\"Platform Discovery\"].public\n| alter registryURL  = xdm.asset.raw_fields -> CWP[\"discovery_data\"].registryURL\n| alter Protected = if (Scan_Status = \"success\", \"Agentless Scan\", Scan_Status = null , \"Not Scanned/Protected\") \n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = coalesce(xdm.asset.tags -> [\"Environment\"], \"None\")\n| alter Environment= uppercase(Environment)\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n| alter Function_Handler  = xdm.asset.raw_fields -> [\"Platform Discovery\"].Handler\n| filter Protected in ($FilteredProtected)\n\n| filter Group_ID in ($FilteredGroup_ID)\n| filter Application in ($FilteredApplication)\n| filter Application_Owner in ($FilteredApplication_Owner)\n| filter Environment in ($FilteredEnvironment)\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n\n| fields  Protected, Public, registryURL, xdm.asset.name as Name, xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type, xdm.asset.provider as Registry_Type, xdm.asset.realm as Cloud_Account, xdm.asset.cloud.region as Cloud_Region, xdm.asset.last_observed as Last_Observed, Group_ID, Application, ApplicationCI, Application_Owner, Environment, Function",
        "time_frame": {
          "relativeTime": 86400000
        },
        "viewOptions": {
          "type": "table",
          "commands": []
        },
        "gridRawStorageInfo": {
          "sort": "{\"colId\":\"Protected\",\"sort\":\"desc\"}",
          "coldefs": {},
          "rowHeight": "{\"rowHeight\":\"stretch\",\"gridRowsHeight\":\"high-row\"}",
          "columnWidth": "\"stretch\""
        }
      },
      "support_time_range": true,
      "additional_info": {
        "query_tables": [
          "asset_inventory"
        ],
        "query_uses_library": false
      },
      "creator_mail": ""
    },
    {
      "widget_key": "xql_1762282748068",
      "title": "Cloud - Container Image Repository Status",
      "creation_time": 1762357909114,
      "description": "",
      "data": {
        "params": [
          {
            "name": "FilteredProtected",
            "value": "*"
          },
          {
            "name": "FilteredGroup_ID",
            "value": "*"
          },
          {
            "name": "FilteredApplication",
            "value": "*"
          },
          {
            "name": "FilteredApplication_Owner",
            "value": "*"
          },
          {
            "name": "FilteredEnvironment",
            "value": "*"
          },
          {
            "name": "FilteredRealm",
            "value": "*"
          },
          {
            "name": "FilteredProvider",
            "value": "*"
          }
        ],
        "phrase": "dataset = asset_inventory\n| filter xdm.asset.type.name in (\"Container Image Repository\")\n| alter Scan_Status  = xdm.asset.raw_fields -> CWP[\"analysis-info__compliance_publisher\"].scan_analysis_result\n| alter Public  = xdm.asset.raw_fields -> [\"Platform Discovery\"].public\n| alter registryURL  = xdm.asset.raw_fields -> CWP[\"discovery_data\"].registryURL\n| alter Protected = if (Scan_Status = \"success\", \"Agentless Scan\", Scan_Status = null , \"Not Scanned/Protected\") \n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = coalesce(xdm.asset.tags -> [\"Environment\"], \"None\")\n| alter Environment= uppercase(Environment)\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n| alter Function_Handler  = xdm.asset.raw_fields -> [\"Platform Discovery\"].Handler\n| filter Protected in ($FilteredProtected)\n\n| filter Group_ID in ($FilteredGroup_ID)\n| filter Application in ($FilteredApplication)\n| filter Application_Owner in ($FilteredApplication_Owner)\n| filter Environment in ($FilteredEnvironment)\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n\n| fields Group_ID, Application, ApplicationCI, Application_Owner, Environment, Function, Protected, Scan_Status, Public, registryURL, xdm.asset.name as Name, xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type, xdm.asset.provider as Registry_Type, xdm.asset.realm as Cloud_Account, xdm.asset.cloud.region as Cloud_Region, xdm.asset.last_observed as Last_Observed\n\n| comp count (Name ) as Repositories by protected\n| sort desc Repositories   \n\n\n\n\n\n| view graph type = pie xaxis = protected yaxis = Repositories valuecolor(\"Agentless Scan\",\"#5400ff\") valuecolor(\"Not Scanned/Protected\",\"#e60404\") ",
        "time_frame": {
          "relativeTime": 86400000
        },
        "viewOptions": {
          "type": "pie",
          "commands": [
            {
              "command": {
                "op": "=",
                "name": "xaxis",
                "value": "protected"
              }
            },
            {
              "command": {
                "op": "=",
                "name": "yaxis",
                "value": "Repositories"
              }
            },
            {
              "func": {
                "args": [
                  "Agentless Scan",
                  "#5400ff"
                ],
                "name": "valuecolor"
              }
            },
            {
              "func": {
                "args": [
                  "Not Scanned/Protected",
                  "#e60404"
                ],
                "name": "valuecolor"
              }
            }
          ]
        },
        "gridRawStorageInfo": {
          "sort": "{\"colId\":\"Protected\",\"sort\":\"desc\"}",
          "coldefs": {},
          "rowHeight": "{\"rowHeight\":\"stretch\",\"gridRowsHeight\":\"high-row\"}",
          "columnWidth": "\"stretch\""
        }
      },
      "support_time_range": true,
      "additional_info": {
        "query_tables": [
          "asset_inventory"
        ],
        "query_uses_library": false
      },
      "creator_mail": ""
    },
    {
      "widget_key": "xql_1762284914912",
      "title": "Cloud - Container Image Status",
      "creation_time": 1762357911091,
      "description": "",
      "data": {
        "params": [
          {
            "name": "FilteredProtected",
            "value": "*"
          },
          {
            "name": "FilteredGroup_ID",
            "value": "*"
          },
          {
            "name": "FilteredApplication",
            "value": "*"
          },
          {
            "name": "FilteredApplication_Owner",
            "value": "*"
          },
          {
            "name": "FilteredEnvironment",
            "value": "*"
          },
          {
            "name": "FilteredRealm",
            "value": "*"
          },
          {
            "name": "FilteredProvider",
            "value": "*"
          }
        ],
        "phrase": "dataset = asset_inventory\n| filter xdm.asset.type.name in (\"Container Image\")\n| alter Scan_Status  = xdm.asset.raw_fields -> CWP[\"analysis-info_csa_compliance_publisher\"].scan_analysis_result\n| alter Protected = if (Scan_Status = \"success\", \"Agentless Scan\", Scan_Status = null , \"Not Scanned/Protected\") \n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = coalesce(xdm.asset.tags -> [\"Environment\"], \"None\")\n| alter Environment= uppercase(Environment)\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n| filter Protected in ($FilteredProtected)\n\n| filter Group_ID in ($FilteredGroup_ID)\n| filter Application in ($FilteredApplication)\n| filter Application_Owner in ($FilteredApplication_Owner)\n| filter Environment in ($FilteredEnvironment)\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n\n| fields Group_ID, Application, ApplicationCI, Application_Owner, Environment, Function, Protected, Scan_Status, xdm.asset.name as Name, xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type, xdm.asset.provider as Cloud, xdm.asset.realm as Cloud_Account, xdm.asset.cloud.region as Cloud_Region, xdm.asset.last_observed as Last_Observed\n| comp count (Name ) as Container_Images by protected\n\n| sort desc Protected \n\n\n\n| view graph type = pie xaxis = protected yaxis = Container_Images valuecolor(\"Not Scanned/Protected\",\"#ec0101\") ",
        "time_frame": {
          "relativeTime": 86400000
        },
        "viewOptions": {
          "type": "pie",
          "commands": [
            {
              "command": {
                "op": "=",
                "name": "xaxis",
                "value": "protected"
              }
            },
            {
              "command": {
                "op": "=",
                "name": "yaxis",
                "value": "Container_Images"
              }
            },
            {
              "func": {
                "args": [
                  "Not Scanned/Protected",
                  "#ec0101"
                ],
                "name": "valuecolor"
              }
            }
          ]
        },
        "gridRawStorageInfo": {
          "sort": "{\"colId\":\"Protected\",\"sort\":\"desc\"}",
          "coldefs": {},
          "rowHeight": "{\"rowHeight\":\"stretch\",\"gridRowsHeight\":\"high-row\"}",
          "columnWidth": "\"stretch\""
        }
      },
      "support_time_range": true,
      "additional_info": {
        "query_tables": [
          "asset_inventory"
        ],
        "query_uses_library": false
      },
      "creator_mail": ""
    },
    {
      "widget_key": "xql_1762300800981",
      "title": "Cloud - Registry Image Status - List",
      "creation_time": 1762357912350,
      "description": "",
      "data": {
        "params": [
          {
            "name": "FilteredProtected",
            "value": "*"
          },
          {
            "name": "FilteredGroup_ID",
            "value": "*"
          },
          {
            "name": "FilteredApplication",
            "value": "*"
          },
          {
            "name": "FilteredApplication_Owner",
            "value": "*"
          },
          {
            "name": "FilteredEnvironment",
            "value": "*"
          },
          {
            "name": "FilteredRealm",
            "value": "*"
          },
          {
            "name": "FilteredProvider",
            "value": "*"
          }
        ],
        "phrase": "dataset = asset_inventory\n| filter xdm.asset.type.name in (\"Registry Image\")\n// | filter xdm.asset.type.name in (\"Runtime Image\", \"Build Image\", \"Registry Image\")\n| alter Scan_Status  = xdm.asset.raw_fields -> CWP[\"scan_information_container_images_registry_caa\"][\"collected_types\"][]\n| alter imageTags  = xdm.asset.raw_fields -> CWP[\"discovery_data\"].imageTags[]\n| alter CloudRepositoryName  = xdm.asset.raw_fields -> [\"Platform Discovery\"].repositoryName\n| alter RepositoryName   = xdm.asset.raw_fields -> CWP[\"discovery_data\"].repositoryName\n| alter RepositoryName  = if (RepositoryName != null, RepositoryName,  CloudRepositoryName != null , CloudRepositoryName) \n| alter registryURL  = xdm.asset.raw_fields -> CWP[\"discovery_data\"].registryURL\n| alter Labels  = xdm.asset.raw_fields -> CWP[\"discovery_data\"][\"config\"].Labels\n| alter CloudImageTags  = xdm.asset.raw_fields -> [\"Platform Discovery\"].imageTags[] \n| alter imageTags  = if (imageTags != null, imageTags,  CloudImageTags != null , CloudImageTags) \n| alter Public  = xdm.asset.raw_fields -> [\"Platform Discovery\"].public\n| alter Architecture  = xdm.asset.normalized_fields -> [\"xdm.image.architecture\"]\n| alter Visibility  = xdm.asset.normalized_fields -> [\"xdm.image.visibility\"]\n| alter ImageName  = xdm.asset.normalized_fields -> [\"xdm.image.names\"][]\n| alter OS = xdm.asset.normalized_fields -> [\"xdm.image.os\"]\n| alter  os_distribution = xdm.asset.normalized_fields -> [\"xdm.image.os_distribution\"]\n| alter  os_family = xdm.asset.normalized_fields -> [\"xdm.image.os_family\"]\n| alter  os_release = xdm.asset.normalized_fields -> [\"xdm.image.os_release\"]\n| alter  specification_type = xdm.asset.normalized_fields -> [\"xdm.image.specification_type\"]\n| alter  size = xdm.asset.normalized_fields -> [\"xdm.image.size\"]\n| alter Protected = if (Scan_Status != null, \"Agentless Scan\", Scan_Status = null , \"Not Scanned/Protected\") \n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = coalesce(xdm.asset.tags -> [\"Environment\"], \"None\")\n| alter Environment= uppercase(Environment)\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n| filter Protected in ($FilteredProtected)\n| filter Group_ID in ($FilteredGroup_ID)\n| filter Application in ($FilteredApplication)\n| filter Application_Owner in ($FilteredApplication_Owner)\n| filter Environment in ($FilteredEnvironment)\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n\n| fields   Protected, Scan_Status, Visibility, Public, xdm.asset.provider as Cloud, xdm.asset.name as Name, ImageName, imageTags, RepositoryName, registryURL, xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type,xdm.asset.realm as Cloud_Account, xdm.asset.cloud.region as Cloud_Region, Architecture, specification_type, os_release, OS, os_distribution, os_family, size, Labels, xdm.asset.last_observed as Last_Observed",
        "time_frame": {
          "relativeTime": 86400000
        },
        "viewOptions": {
          "type": "table",
          "commands": []
        },
        "gridRawStorageInfo": {
          "sort": "{\"colId\":\"xdm__asset__type__name\",\"sort\":\"asc\"}",
          "coldefs": {},
          "rowHeight": "{\"rowHeight\":\"stretch\",\"gridRowsHeight\":\"high-row\"}",
          "columnWidth": "\"stretch\""
        }
      },
      "support_time_range": true,
      "additional_info": {
        "query_tables": [
          "asset_inventory"
        ],
        "query_uses_library": false
      },
      "creator_mail": ""
    },
    {
      "widget_key": "xql_1762343679812",
      "title": "Cloud - Container Registry Status",
      "creation_time": 1762357913190,
      "description": "",
      "data": {
        "params": [
          {
            "name": "FilteredProtected",
            "value": "*"
          },
          {
            "name": "FilteredGroup_ID",
            "value": "*"
          },
          {
            "name": "FilteredApplication",
            "value": "*"
          },
          {
            "name": "FilteredApplication_Owner",
            "value": "*"
          },
          {
            "name": "FilteredEnvironment",
            "value": "*"
          },
          {
            "name": "FilteredRealm",
            "value": "*"
          },
          {
            "name": "FilteredProvider",
            "value": "*"
          }
        ],
        "phrase": "dataset = asset_inventory\n| filter xdm.asset.type.name in (\"Container Registry\")\n| alter Scan_Status  = xdm.asset.raw_fields -> CWP[\"analysis-info__compliance_publisher\"].scan_analysis_result\n| alter AzurePublic = xdm.asset.raw_fields -> [\"Platform Discovery\"][\"properties\"].publicNetworkAccess\n| alter AwsPublic = xdm.asset.raw_fields -> [\"Platform Discovery\"].public\n| alter Public  = if (AzurePublic != null, AzurePublic,  AwsPublic != null , AwsPublic) \n| alter Repositories = xdm.asset.raw_fields -> [\"Platform Discovery\"][\"repositories\"][]\n| alter Protected = if (Scan_Status = \"success\", \"Agentless Scan\", Scan_Status = null , \"Not Scanned/Protected\") \n| alter Group_ID = coalesce(xdm.asset.tags -> [\"Group_ID\"], \"None\")\n| alter Application = coalesce(xdm.asset.tags -> [\"Application\"], \"None\")\n| alter ApplicationCI = coalesce(xdm.asset.tags -> [\"ApplicationCI\"], \"None\")\n| alter Application_Owner = coalesce(xdm.asset.tags -> [\"Application_Owner\"], \"None\")\n| alter Environment = coalesce(xdm.asset.tags -> [\"Environment\"], \"None\")\n| alter Environment= uppercase(Environment)\n| alter Function = coalesce(xdm.asset.tags -> [\"Function\"], \"None\")\n| filter Protected in ($FilteredProtected)\n| filter Group_ID in ($FilteredGroup_ID)\n| filter Application in ($FilteredApplication)\n| filter Application_Owner in ($FilteredApplication_Owner)\n| filter Environment in ($FilteredEnvironment)\n| filter xdm.asset.realm in ($FilteredRealm)\n| filter xdm.asset.provider in ($FilteredProvider)\n| fields Protected,  Public, xdm.asset.name as Name,  xdm.asset.strong_id as ResourceID, xdm.asset.type.name as Type, xdm.asset.provider as Regitry_Type, xdm.asset.realm as Cloud_Account, Repositories, xdm.asset.tags as Tags, xdm.asset.last_observed as Last_Observed\n| comp count (Name ) as Registries by protected\n| sort desc Registries \n\n\n| view graph type = pie xaxis = protected yaxis = Registries valuecolor(\"Not Scanned/Protected\",\"#ec0101\") valuecolor(\"Agentless Scan\",\"#5400ff\") ",
        "time_frame": {
          "relativeTime": 86400000
        },
        "viewOptions": {
          "type": "pie",
          "commands": [
            {
              "command": {
                "op": "=",
                "name": "xaxis",
                "value": "protected"
              }
            },
            {
              "command": {
                "op": "=",
                "name": "yaxis",
                "value": "Registries"
              }
            },
            {
              "func": {
                "args": [
                  "Not Scanned/Protected",
                  "#ec0101"
                ],
                "name": "valuecolor"
              }
            },
            {
              "func": {
                "args": [
                  "Agentless Scan",
                  "#5400ff"
                ],
                "name": "valuecolor"
              }
            }
          ]
        },
        "gridRawStorageInfo": {
          "sort": "{\"colId\":\"Protected\",\"sort\":\"asc\"}",
          "coldefs": {},
          "rowHeight": "{\"rowHeight\":\"stretch\",\"gridRowsHeight\":\"high-row\"}",
          "columnWidth": "\"stretch\""
        }
      },
      "support_time_range": true,
      "additional_info": {
        "query_tables": [
          "asset_inventory"
        ],
        "query_uses_library": false
      },
      "creator_mail": ""
    }
  ],
  "id": "",
  "name": "CNAPP - Container/VM Image Protection/Scan Status"
}